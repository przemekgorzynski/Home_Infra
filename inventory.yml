---
all:
  vars:
    admin_group:
      - name: admins
        gid: 1100
    users:
      - name: "{{ lookup('community.general.bitwarden', 'os_account', field='username')[0] }}"
        groups: 'users,sudo,adm,www-data,admins'
        shell: '/bin/bash'
        state: present
        uid: 1000
        private_key_path: '~/.ssh/ssh-ed25519'
    timezone: Europe/Warsaw
    standard_packages:
      - docker.io
      - docker-compose
      - curl
      - network-manager
      - git
      - net-tools
      - vim
      - wget
      - ufw
      - fail2ban
      - python3-pip
  hosts:
    localhost:
      ansible_connection: local
    nas:
      domain: gorillabay.org
      hostname: nas
      type: pc
      ansible_host: 10.0.0.10
      ansible_user: "{{ lookup('community.general.bitwarden', 'os_account', field='username')[0] }}"
      ansible_become_password: "{{ lookup('community.general.bitwarden', 'os_account', field='password')[0] }}"
      samba_shares_partition:
        - uuid: 1c5dcb51-59e7-4013-95e2-b2662611ccba   # 2TB
          path: /samba_shares
          chmod: '0777'
          fstype: ext4
          opts: defaults,nofail
      samba_backup_partition:
        - uuid: 6e88906f-dafc-476c-8a49-e345710f016f   # 4TB
          path: /samba_backup
          chmod: '0777'
          fstype: ext4
          opts: defaults,nofail
      tooling_dirs:
        - path: /samba_shares/config_files
          chmod: '0770'
      tools:
        docker:
          network:
            name: tooling
        traefik:
          docker_image: traefik
          docker_image_tag: latest
          image_digest: sha256:7996bdae8aaa70eaacf2978b6c949de5b68c0a24ddc3e40c06344ecc88cfaea3
          container_name: traefik
          log_dir: /var/log/traefik.log   # Host path, log file mounted into cintainer
          dynu_api_key: "{{ lookup('community.general.bitwarden', 'dynu_api_key', field='password')[0] }}"
        jellyfin:
          docker_image: lscr.io/linuxserver/jellyfin
          docker_image_tag: latest
          image_digest: sha256:b5b7ee2edbd2957d9981877d2e3db60c5a38ec7e0aca659d49e670f8f6941d1f
          container_name: jellyfin
          docker_volume_name: jellyfin_volume
          ports:
            - 8096:8096
          media_dirs:
            - /samba_shares/shares/filmy
            - /samba_shares/shares/inne
            - /samba_backup/new
        nextcloud:
          app:
            docker_image: nextcloud
            docker_image_tag: latest
            image_digest: sha256:a29409ebc74c6225b1f9376d596383555ba3a72d099f8fb2e48963322c8d0b5c
            container_name: nextcloud
            docker_volume_name: nextcloud_app_volume
            host_port: 4000
            container_port: 80
            admin_user: "{{ lookup('community.general.bitwarden', 'nextcloud_admin', field='username')[0] }}"
            admin_password: "{{ lookup('community.general.bitwarden', 'nextcloud_admin', field='password')[0] }}"
            trusted_domains: "nextcloud.{{ domain }},{{ domain }}"
          db:
            docker_image: mariadb
            docker_image_tag: latest
            image_digest: sha256:f0a6faee9d0e55492f238d1d11ff13d77616ea12d8c38bedf090da2ee05532be
            container_name: nextcloud_db
            docker_volume_name: nextcloud_db_volume
            mysql_root_password: "{{ lookup('community.general.bitwarden', 'nextcloud_mysql_root_password', field='password')[0] }}"
            mysql_user: "{{ lookup('community.general.bitwarden', 'nextcloud_mysql_user', field='username')[0] }}"
            mysql_password: "{{ lookup('community.general.bitwarden', 'nextcloud_mysql_user', field='password')[0] }}"
            mysql_database: nextclouddb

# pi:
#   hostname: pi
#   type: raspberry
#   ansible_host: 10.0.0.20
#   ansible_user: "{{ lookup('community.general.bitwarden', 'os_initial_account_pi', field='username')[0] }}"
#   ansible_ssh_pass: "{{ lookup('community.general.bitwarden', 'os_initial_account_pi', field='password')[0] }}"
#   ansible_become_password: "{{ lookup('community.general.bitwarden', 'os_initial_account_pi', field='password')[0] }}"
# dell-sandbox:
#   hostname: dell-sandbox
#   type: notebook
#   ansible_host: 10.0.0.30
#   ansible_user: "{{ lookup('community.general.bitwarden', 'os_account', field='username')[0] }}"
#   ansible_ssh_pass: "{{ lookup('community.general.bitwarden', 'os_account', field='password')[0] }}"
#   ansible_become_password: "{{ lookup('community.general.bitwarden', 'os_account', field='password')[0] }}"
